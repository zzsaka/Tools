# MD to Excel Converter

このプログラムはMarkdownファイルをExcelファイルに変換するためのツールです。

## 機能

- Markdownの見出し（`#`、`##`など）をExcelの階層構造として表現
- Markdownの表をExcelの表に変換（整列記号 `:---:`、`:---`、`---:` にも対応）
- 日本語と英語が混在するテキストに対応した適切なカラム幅の自動調整
- 見出しレベルに応じた書式設定（フォントサイズ、色、背景色）
- 数値データの自動的な右揃え表示
- 改行を含む段落の適切な表示
- 複数ファイルの一括変換
- 文字コードの自動検出（UTF-8, Shift-JIS, EUC-JP, ISO-2022-JP）
- 詳細なエラー処理とロギング機能
- 出力ディレクトリが存在しない場合の自動作成

## 必要条件

- Python 3.6以上
- 以下のPythonパッケージ
  - pandas
  - openpyxl

## インストール

必要なパッケージをインストールします：

```bash
pip install pandas openpyxl
```

## 使い方

### コマンドライン

基本的な使い方：

```bash
python md_to_excel.py input.md
```

出力ファイル名とシート名を指定する場合：

```bash
python md_to_excel.py input.md -o output.xlsx -s "シート名"
```

複数のファイルを一括変換：

```bash
python md_to_excel.py file1.md file2.md file3.md
```

デバッグ情報を表示：

```bash
python md_to_excel.py input.md -d
```

### オプション

- `-o, --output`: 出力するExcelファイルのパス（省略時は入力ファイル名.xlsx）
- `-s, --sheet`: 出力Excelファイルのシート名（デフォルト: "Sheet1"）
- `-d, --debug`: デバッグ情報を表示
- `-v, --version`: バージョン情報を表示して終了
- `--overwrite`: 既存のファイルを上書きする（警告を表示しない）

## サンプルMarkdownファイル

サンプルとして以下のようなMarkdownファイルを変換してみましょう：

```markdown
# プロジェクト計画書

## プロジェクト概要
このプロジェクトは新しい顧客管理システムの開発を目的としています。

## チームメンバー

| 役割 | 氏名 | 部署 |
|------|------|------|
| プロジェクトマネージャー | 山田太郎 | システム開発部 |
| リードエンジニア | 佐藤二郎 | システム開発部 |
| デザイナー | 鈴木花子 | UIデザイン部 |

## スケジュール

### フェーズ1: 要件定義
2025年5月1日〜2025年5月15日

### フェーズ2: 設計
2025年5月16日〜2025年5月31日

### フェーズ3: 開発
2025年6月1日〜2025年7月15日
```

## 変換結果

上記のMarkdownファイルを変換すると、以下のようなExcelファイルが生成されます：

1. 「プロジェクト計画書」が大見出しとして設定され、背景色が付きます
2. 「プロジェクト概要」「チームメンバー」「スケジュール」が中見出しとして設定されます
3. 「フェーズ1〜3」が小見出しとして設定されます
4. チームメンバーの表が適切な列幅と罫線付きで表示されます

## 注意事項

- 複雑なMarkdown記法（コードブロック、画像、リンクなど）は現在サポートされていません
- 非常に大きなMarkdownファイルの場合、処理に時間がかかる場合があります
- 出力先のExcelファイルが開かれている場合、保存に失敗します

## トラブルシューティング

### よくある問題

1. **ModuleNotFoundError**: `pandas`や`openpyxl`がインストールされていない場合
   ```
   pip install pandas openpyxl
   ```

2. **PermissionError**: 出力先のExcelファイルが他のプログラムで開かれている場合
   ```
   他のプログラムでExcelファイルを閉じてから再試行してください
   ```

3. **UnicodeDecodeError**: Markdownファイルの文字コードが正しく認識されない場合
   ```
   テキストエディタでMarkdownファイルをUTF-8で保存し直してください
   ```

4. **FileNotFoundError**: 入力ファイルが見つからない場合
   ```
   ファイルパスが正しいか確認してください
   デバッグモード (-d) を使用するとより詳細な情報が表示されます
   ```

5. **出力フォルダへのアクセス権限がない場合**:
   ```
   適切な権限を持つフォルダを指定するか、管理者権限で実行してください
   ```

### デバッグモードの使用

問題が発生した場合は、デバッグモードを使用することで詳細な情報を確認できます：

```bash
python md_to_excel.py input.md -d
```

### 複数ファイルの変換でエラーが発生した場合

複数ファイルを一括変換する際に一部のファイルでエラーが発生しても、処理は続行されます。
エラーが発生したファイルのリストは処理終了時に表示されます。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細については、[LICENSE](LICENSE)ファイルを参照してください。

## 連絡先

問題や提案がある場合は、Issueを作成してください。
